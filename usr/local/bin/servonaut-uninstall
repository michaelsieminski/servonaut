#!/bin/bash

# Ensure root privileges for the script to work
if [ "$(id -u)" != "0" ]; then
    echo "This script must be run as root" 1>&2
    exit 1
fi

# Stop and remove Nuxt service
systemctl stop nuxt.service
systemctl disable nuxt.service
rm /etc/systemd/system/nuxt.service

# Stop and remove Caddy service
systemctl stop caddy.service
systemctl disable caddy.service
rm /etc/systemd/system/caddy.service

# Remove Caddy configuration
rm -rf /etc/caddy

# Remove Caddy binary
rm /usr/local/bin/caddy

# Remove Nuxt project directory
rm -rf /var/www/app

# Remove Bun
rm -rf ~/.bun
rm /usr/local/bin/bun

# Remove SSH key (if it was created)
rm -f /root/.ssh/id_ed25519*

# Remove the servonaut scripts
rm /usr/local/bin/servonaut
rm -rf /usr/local/lib/servonaut

echo "Servonaut has been uninstalled. You may need to manually remove any remaining files or configurations."
