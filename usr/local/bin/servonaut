#!/bin/bash

source /usr/local/lib/servonaut/utils.sh
source /usr/local/lib/servonaut/install_dependencies.sh
source /usr/local/lib/servonaut/setup_caddy.sh
source /usr/local/lib/servonaut/setup_nuxt.sh

# Ensure root privileges for the script to work
check_root

# Update and upgrade the packages
update_system

# Install dependencies
install_dependencies

# Setup Caddy
setup_caddy

# Setup Nuxt project
setup_nuxt

# Reload systemd and restart Nuxt service
systemctl daemon-reload
systemctl restart nuxt.service

echo "Setup complete! You can now access your Nuxt application at http://$domain_name"
echo "Follow the instructions provided earlier to enable HTTPS once your DNS is updated."